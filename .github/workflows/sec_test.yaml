name: Security test

on: [push]

jobs:
    sast_scan:
        name: Run Bandit Scan
        runs-on: ubuntu-latest
        strategy:
          fail-fast: false
          matrix:
            python-version: ["3.13"]

        steps:
        - name: Checkout code
          uses: actions/checkout@v4

        - name: Set up Python
          uses: actions/setup-python@v5
          with: 
            python-version: ${{ matrix.python-version }}

        - name: Display Python version
          run: python -c "import sys; print(sys.version)"
        
        - name: Install Bandit
          run: pip install bandit

        - name: Run Bandit Scan
          run: bandit -ll -ii -r . -f json -o bandit_report.json
        
        - name: Upload Artifact
          uses: actions/upload-artifact@v4
          if: always() 
          with:
            name: bandit-findings
            path: bandit_report.json